#### 浏览器发送请求页面加载过程
1. 域名解析：
    - 首先浏览器会查找自身缓存是否存在此域名解析有则返回，没有会到操作系统中缓存查找是否有该域名的解析
    - 都没有找到情况下会从本地 `DNS` 服务器中查找有没有缓存记录，如果命中缓存则返回该域名的解析
    - 如果解析不到，则通过转发模式进行一级一级的查找，如果没有设置转发模式会向根服务器发起查询请求
    - 根服务器会根据所知的顶层域名服务器依次发起查找请求，查找的过程是迭代以及递归的形式
2. 发起请求：
    - 向`IP`服务器发送数据请求，在请求之前先做 `TCP/IP` 连接，连接的时候会执行三次握手，向服务端建立连接会发送带有 `SYN` 标识符，服务端收到后会返回 `SYN/ACK` 标识，客户端收到后会返回 `ACK` 标识，握手完毕后发送请求，浏览器将 `HTTP` 报文进行层层封装，通过网络传递给服务器
3. 是否存在缓存：
    - 假设第一次请求此域名从来没有被访问过，收到响应信息包含一些强弱缓存字段
    - 强缓存
        - `Expires` 的值是 `HTTP` 时间如果本机系统时间与服务器时间不一致则会导致假性失效
        - `Cache-control` `HTTP1.1` 新增属性
            - `max-age` 单位秒，距离第一次响应头中该字段的时间，如果时间超过重新发起请求
            - `no-cache` 不使用强缓存，每次请求都需要向服务器校验文件新鲜度
            - `no-store` 不使用任何缓存，每次请求都是最新的资源
            - `private` 专用于个人的缓存，中间代理以及 `CDN` 不能缓存此响应
            - `public` 响应可以被 `CDN` 中间代理所缓存
        - `pragma` 不适用强缓存，需要验证缓存是否新鲜
        - 强缓存优先级 `pragma` > `cache-control` > `expires`
    - 在服务器第一次响应时，有可能有强缓存字段，也有可能没有，也可能有弱缓存字段
    - 弱缓存
        - `last-modified` 最后一次文件修改的时间，单位是秒，浏览器在下一次请求中携带 `if-moditied-since` 字段对比该文件时间
        - `Etag` 是一个 `hash` 串代表当前资源的标识符，浏览器在下一次请求中携带 `if-not-match` 字段对比资源是否过期
3. 服务端解析：
    - 服务端会对请求报文做一些处理，判断当前请求方式以及请求的资源
    - 如果是静态资源 `css png html` 等会走文件系统查看一下文件是否存在，如果存在的话就读取文件内容，返回给客户端浏览器
    - 如果是一个动态资源的话会根据数据库的连接，查找数据库最终通过响应封装返回数据
4. `HTML` 文档解析：
    - 在请求到资源后，浏览器需要解析 `HTML` 生成 `DOM` 树和 `CSSDOM` 树，结合形成 `render` 树之后再进行渲染
    - 解析 `HTML` 分为词法解析和语法解析
5. `CSS` 解析：
    - 在解析 `HTML` 同时也会解析 `CSS` 两者并行执行，解析完毕之后会生成一个 `stylesheet` 对象，最终将两者生成 `render` 树
6. 绘制阶段：
    - 根据 `GPU` 渲染引擎进行绘制，通过显卡将内容绘制到屏幕上，绘制完毕后浏览器会和服务器进行四次挥手，当服务器确定接收完后断开连接

---

#### 页面渲染过程
1. 浏览器解析器接收到网络资源后解析 `html` 并构建 `dom` 树 
    - 浏览器收到字节数据，会根据字节数据转换为字符串
    - 将这些字符串通过词法分析转换为标记（token），这一过程词法分析中叫做标记化（tokenization）
    - 标记转换为 `node`，根据不同的节点之间的联系构建 `dom` 树
    - 在解析 `html` 文件时候，当遇到 `css` 和 `js` 文件，浏览器会去下载解析这些资源文件，阻塞渲染

2. 解析 `css` 构建样式树
    - 浏览器会通过递归方式确定每一个节点是什么样式，消耗性能
    - 尽量避免多层次的选择器，减少无意义的标签

3. 合并 `dom/css` 树生成渲染树
    - 渲染树只会包括需要显示的节点
    - 不显示的节点 `display:none\script\link\meta` 等

4. 回流
    - 根据生成的渲染树，从渲染根节点开始遍历，计算每一个元素的几何信息

5. 重绘
    - 最终得到所有可见的节点以及元素的几何信息，然后将渲染树每个节点转换成屏幕上的像素点

##### 总结
1. `JS` 与 `CSS` 都是阻塞页面渲染的资源
2. 可以通过媒体查询解除解决 `CSS` 在特定场景阻塞的问题
3. 可通过为 `script` 添加异步属性来防止阻塞

补充： `CSS` 可以通过打包工具转化成 `js`，在页面加载时，通过异步加载 `js` 资源，然后应用样式。这也是可以防止 `css` 阻塞渲染的一种方式

---